# 更新日誌 (CHANGELOG)

## [2.1.1] - 2025-01-17

### 🗂️ 資料庫重新整理 (Database Reorganization)

- **檔案命名統一化**

  - 採用一致的 kebab-case 命名規則
  - 中文檔案名稱改為英文
  - 移除重複和冗餘檔案

- **檔案結構優化**

  - `earthly-branch-numbers.js` → `earthly-branches.js`
  - `i-ching-data.js` → `iching-hexagrams.js` (主要易經資料)
  - `i-ching-palace.js` → `iching-palaces.js`
  - `i-ching-lines.js` → `iching-lines.js`
  - `primal-bagua-map.js` → `bagua-map.js`
  - `yao-ci-explanations.js` → `yao-explanations.js`
  - `伏羲先天八卦.png` → `fuxi-bagua.png`

- **重複檔案清理**

  - 刪除 `hexagram-data.js` (與 `iching-data.js` 重複)
  - 保留更完整的資料版本

- **引用更新**

  - 更新 `index.html` 中的所有檔案引用路徑
  - 確保 `fortune.js` 正常載入所有資料檔案
  - 維持原有變數名稱保證兼容性

- **文檔完善**
  - 新增 `/database/README.md` 詳細說明資料庫結構
  - 更新主 README 說明檔案組織
  - 添加檔案依賴關係圖表

### 📊 資料庫統計

- 整理前：11 個檔案（含重複）
- 整理後：10 個檔案（移除重複）
- 總資料項目：1000+ 個易經相關資料點
- 檔案命名一致性：100%

## [2.1.0] - 2025-07-17

### 🎯 重大更新 (Major Updates)

- **全平台響應式重構**：完整的手機平板自適應設計
  - 移動優先的設計策略
  - 三層斷點系統（480px, 768px, 1024px）
  - 觸控優化與手勢友好設計
  - 完整的 PWA 支援與 meta 標籤優化

### ✨ 新增功能 (Added Features)

- **響應式導航系統**
  - 桌面版：左側邊欄固定導航
  - 移動版：底部水平導航，單手操作友好
  - 自適應導航按鈕尺寸和間距
- **觸控體驗優化**

  - 符合 iOS 44px 最小觸控目標標準
  - 防誤觸間距設計
  - 平滑捲動支援（iOS Safari 兼容）
  - 觸控回饋與視覺狀態

- **移動設備專屬功能**
  - 增強型 viewport 設定（支援縮放控制）
  - 全螢幕模式支援（iOS/Android）
  - 硬體加速動畫優化
  - 防止意外水平捲動

### 🎨 UI/UX 改進 (UI/UX Improvements)

- **自適應佈局系統**

  - 桌面：雙欄佈局保持完整功能
  - 平板：優化間距和字體大小
  - 手機：單欄佈局，內容優先顯示
  - 小螢幕：極致精簡化設計

- **字體與間距優化**

  - 響應式字體大小系統
  - 自適應內容間距
  - 行高和可讀性優化
  - 觸控友好的表單元素

- **子頁面響應式支援**
  - `what_to_eat.html` 完整響應式重構
  - 表單元素移動端全寬度適配
  - iframe 最小高度自適應
  - 主題色跨頁面同步

### 🔧 修復 (Fixed)

- 修復小螢幕下導航按鈕過小的問題
- 解決移動設備上的觸控響應延遲
- 修正 iframe 內容在手機上的顯示問題
- 優化側邊欄在平板橫向模式的佈局
- 修復 CSS 變量在某些瀏覽器的兼容性問題

### 🚀 性能優化 (Performance)

- 優化 CSS 媒體查詢的載入順序
- 減少重繪和回流的 CSS 屬性使用
- 改善觸控事件的響應速度
- 優化字體渲染和視覺效果

---

## [2.0.0] - 2025-07-16

### 🎯 重大更新 (Major Updates)

- **模組化重構**：將單一大型 `fortune.js` 重構為模組化架構

  - 8 個獨立資料庫模組化檔案
  - 清晰的專案目錄結構
  - 更好的程式碼可維護性

- **多層 CORS 代理系統**：實現穩定的外部 API 訪問

  - 4 層備用代理系統 (corsproxy.io, allorigins.win, cors-anywhere, proxy.cors.sh)
  - 自動故障轉移機制
  - 提升 API 呼叫成功率

- **生產環境優化**：程式碼清理與優化

  - 移除所有測試與除錯程式碼
  - 清理註解與無用變數
  - 優化載入效能

### ✨ 新增功能 (Added Features)

- **模組化資料庫** (`database/` 目錄)

  - `earthly-branch-numbers.js` - 地支數字對照
  - `gua-colors.js` - 八卦顏色對照
  - `hexagram-matrix.js` - 六十四卦矩陣
  - `i-ching-data.js` - 易經爻辭資料
  - `i-ching-lines.js` - 易經爻線資料
  - `i-ching-palace.js` - 易經宮位對照
  - `primal-bagua-map.js` - 先天八卦對照
  - `yao-ci-explanations.js` - 爻辭白話解釋

- **API 穩定性提升**

  - 多重代理備援系統
  - 智能 API 切換機制
  - 增強錯誤處理

### 🔧 修復 (Fixed)

- 修復重複載入腳本導致的變數衝突問題
- 解決 CORS 政策限制的外部 API 訪問問題
- 修正陽曆轉陰曆功能的精確度
- 優化星座資訊獲取邏輯的穩定性

### 🚀 改進 (Improved)

- 大幅提升程式碼組織結構
- 增強 API 呼叫的可靠性
- 優化使用者體驗與響應速度
- 完善錯誤處理機制

---

## [1.5.0] - 2025-07-12

### ✨ 新增功能

- 實現時間起卦系統（梅花易數）
- 網站全面改版，提升使用者介面
- 新增「待會吃什麼？」功能頁面
- 實現三層整合運勢分析系統

### 🔧 修復

- 改善占星 API 可靠性，新增多重來源與備援
- 調整 iframe 嵌入式佈局
- 修正易經占卜文字的 CSS 樣式
- 優化側邊欄導航流程

### 📝 文檔

- 新增完整的中文 README.md
- 移除 emoji 表情符號，保持介面簡潔

---

## [1.0.0] - 2025-07-10

### 🎉 首次發布

- 完整的易經占卜系統，含詳細解釋
- 基礎網站架構與導航
- 核心運勢分析功能
- 初始專案結構建立

---

## 版本說明

- **Major (主版本)**：架構重大變更或不相容更新
- **Minor (次版本)**：新功能新增，向下相容
- **Patch (修訂版)**：錯誤修復與小幅改進

## 技術棧演進

### v2.0.0 技術特色

- 🏗️ **模組化架構**：ES6 模組化設計
- 🌐 **多層代理**：4 層 CORS 代理備援
- 📅 **農曆轉換**：使用 lunar-javascript 庫
- 🎯 **時間起卦**：傳統梅花易數算法
- 🔮 **易經系統**：完整六十四卦資料庫

### v1.x 基礎功能

- 易經占卜核心邏輯
- 基礎網頁介面
- 簡單 API 整合
- 基礎運勢分析

---

_本專案致力於運用現代技術實現古典占卜的數位化呈現。_
